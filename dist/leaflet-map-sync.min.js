!function(a,b,c,d,e){"use strict";var f,g=[22,26],h={cursor:{iconMargin:[-1,0],cssClasses:["auto","default","initial","inherit"]},pointer:{iconMargin:[-7,-2],cssClasses:["pointer"]},none:{iconMargin:[0,0],cssClasses:["none"]},wait:{iconMargin:[-11,-10],cssClasses:["progress","wait"]},cell:{iconMargin:[-11,-11],cssClasses:["cell"]},crosshair:{iconMargin:[-11,-10],cssClasses:["crosshair"]},move:{iconMargin:[-11,-9],cssClasses:["move","all-scroll"]},"not-allowed":{iconMargin:[-11,-11],cssClasses:["no-drop","not-allowed"]},"ns-resize":{iconMargin:[-11,-9],cssClasses:["ns-resize","n-resize","s-resize"]},"ew-resize":{iconMargin:[-11,-9],cssClasses:["ew-resize","e-resize","w-resize"]},"ne-resize":{iconMargin:[-11,-10],cssClasses:["ne-resize","sw-resize","nesw-resize"]},"nw-resize":{iconMargin:[-11,-10],cssClasses:["nw-resize","se-resize","nwse-resize"]},"zoom-in":{iconMargin:[-10,-9],cssClasses:["zoom-in"]},"zoom-out":{iconMargin:[-10,-9],cssClasses:["zoom-out"]},grab:{iconMargin:[-8,-8],cssClasses:["grab","-webkit-grab","-moz-grab"]},grabbing:{iconMargin:[-8,-8],cssClasses:["grabbing","-webkit-grabbing","-moz-grabbing"]}},i={};for(var j in h){f=h[j].cssClasses;for(var k=0;k<f.length;k++)i[f[k]]=j}var l={animate:!1,reset:!0};b.MapSync=b.Class.extend({options:{VERSION:"{VERSION}",iconName:"hand"},initialize:function(a){b.setOptions(this,a),this.list=[],this.onlySetViewOnTarget=!1,this.show()},add:function(c,d){d=b.Util.extend(d||{},{}),this.list.push(c),this.masterMap=this.masterMap?this.masterMap:c,c!=this.masterMap&&c.setView(this.masterMap.getCenter(),this.masterMap.getZoom(),l),c.mapSync=this,c.options=c.options||{},c.options.mapSync={enabled:!1,$map_container:a(c._container)},b.extend(c,{setView:function(a){return function(){return a.apply(this,arguments),this.options.mapSync.enabled&&!this.mapSync.onlySetViewOnTarget&&this.mapSync._forEachMap({mapFunction:function(a,c){b.Map.prototype.setView.apply(a,c)},arguments:arguments,excludeMap:c}),this}}(b.Map.prototype.setView),panBy:function(a){return function(){return a.apply(this,arguments),this.options.mapSync.enabled&&this.mapSync._forEachMap({mapFunction:function(a,c){b.Map.prototype.panBy.apply(a,c)},arguments:arguments,excludeMap:this}),this}}(b.Map.prototype.panBy),_onResize:function(a){return function(){return a.apply(this,arguments),this.options.mapSync.enabled&&this.mapSync._forEachMap({mapFunction:function(a,c){b.Map.prototype._onResize.apply(a,c)},arguments:arguments,excludeMap:this}),this}}(b.Map.prototype._onResize)}),c.dragging._draggable._updatePosition=function(a){return function(){a.apply(this,arguments),c.options.mapSync.enabled&&c.mapSync._forEachMap({mapFunction:function(a,c){b.DomUtil.setPosition(a.dragging._draggable._element,c._newPos),a.fire("moveend")},arguments:[this],excludeMap:c})}}(b.Draggable.prototype._updatePosition),c.boxZoom._finish=function(a){return function(){this._map.mapSync.onlySetViewOnTarget=!0,a.apply(this,arguments)}}(b.Map.BoxZoom.prototype._finish),c.on("boxzoomend",function(){this.mapSync.onlySetViewOnTarget=!1}),c.on("zoomend",function(){this.options.mapSync.enabled&&this.mapSync._forEachMap({mapFunction:function(a,b){a.setView(b.getCenter(),b.getZoom(),l)},arguments:[this],excludeMap:this})});var e=b.divIcon({className:"map-sync-cursor-icon",iconSize:g});c.options.mapSync.cursorMarker=b.marker(c.getCenter(),{icon:e}).addTo(c),c.options.mapSync.cursorContainer=b.DomUtil.create("div","map-sync-cursor-container",c._mapPane),c._panes.markerPane.removeChild(c.options.mapSync.cursorMarker._icon),c.options.mapSync.cursorContainer.appendChild(c.options.mapSync.cursorMarker._icon);var f=this;c.on("mouseover",function(){f._onMouseOverMap(c)}),c.on("mouseout",function(){f._onMouseOutMap(c)}),c.on("mousemove",function(a){c.options.mapSync.enabled&&c.mapSync._forEachMap({mapFunction:function(a,b){a.options.mapSync.cursorMarker.setLatLng(b)},arguments:[a.latlng],inclDisabled:!0})}),c.on("zoomstart movestart",function(){c.options.mapSync.enabled&&c.mapSync.hide()}),c.on("zoomend moveend",function(){c.options.mapSync.enabled&&c.mapSync._showOnFirstMove()});var h=function(a){c.options.mapSync.enabled&&f._setCursorFromMouseEvent(a)};a(c._controlContainer).on("mouseover",h),a(c._container).on("mouseover",h);for(var i in c._panes)a(c._panes[i]).on("mouseover",h);var j=function(){f._setCursorFromElement(c._container)};c.on("dragstart",function(){c.options.mapSync.enabled&&c.once("mousemove",j)}),c.on("dragend zoomend moveend boxzoomend",function(){c.options.mapSync.enabled&&j()}),this.enable(c)},show:function(){a("html").removeClass("no-map-sync"),a("html").addClass("map-sync")},hide:function(){a("html").addClass("no-map-sync"),a("html").removeClass("map-sync")},enable:function(a){if(a.options&&a.options.mapSync&&a.mapSync==this){var b,c;for(b=0;b<this.list.length;b++)if(c=this.list[b],c!=a&&c.options.mapSync.enabled){a.setView(c.getCenter(),c.getZoom(),l);break}a.options.mapSync.$map_container.addClass("map-sync-enabled"),a.options.mapSync.enabled=!0,this._forEachMap({mapFunction:function(a){a.options.mapSync.$map_container.hasClass("map-sync-mouseover")&&a.mapSync._onMouseOverMap(a)}})}},disable:function(a){a.options&&a.options.mapSync&&a.mapSync==this&&(a.options.mapSync.$map_container.hasClass("map-sync-mouseover")&&this._onMouseOutMap(a),a.options.mapSync.$map_container.removeClass("map-sync-enabled"),a.options.mapSync.enabled=!1)},remove:function(a){for(var b=0;b<this.list.length;b++)if(this.list[b]==a){this.list.splice(b,1);break}},forEachMap:function(a,b){for(var c=0;c<this.list.length;c++)(b||this.list[c].options.mapSync.enabled)&&a(this.list[c],c)},_forEachMap:function(a){var b,c,d;for(b=0;b<this.list.length;b++)c=this.list[b],c!=a.excludeMap&&(a.inclDisabled||c.options.mapSync.enabled)&&(d=[c],a.mapFunction.apply(e,d.concat(a.arguments||[])))},_onMouseOverMap:function(a){a.options.mapSync.$map_container.addClass("map-sync-mouseover"),a.options.mapSync.enabled&&this._forEachMap({mapFunction:function(a){a.options.mapSync.$map_container.addClass("map-sync-passive")},excludeMap:a})},_onMouseOutMap:function(a){a.options.mapSync.$map_container.removeClass("map-sync-mouseover"),a.options.mapSync.enabled&&this._forEachMap({mapFunction:function(a){a.options.mapSync.$map_container.removeClass("map-sync-passive")},inclDisabled:!0})},_showOnFirstMove:function(){var a=this;this._forEachMap({mapFunction:function(b){b.once("mousemove",a.show,a)},inclDisabled:!0})},_setCursorFromMouseEvent:function(a){this._setCursorFromElement(a.target)},_setCursorFromElement:function(b){var c=a(b).css("cursor"),d=i[c]||"default";this._changeCursor(d)},_changeCursor:function(b){var c=h[b].iconMargin||[0,0];this._forEachMap({mapFunction:function(b,c,d,e){var f=a(b.options.mapSync.cursorMarker._icon);f.removeClass("icon-"+c),f.addClass("icon-"+d),f.css({marginLeft:e[0]+"px",marginTop:e[1]+"px"})},arguments:[this.options.iconName,b,c],inclDisabled:!0}),this.options.iconName=b}})}(jQuery,L,this,document);